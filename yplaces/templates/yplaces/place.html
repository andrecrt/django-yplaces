{% extends 'yplaces/base.html' %}

{% load staticfiles %}

{% block body %}

<div class="place">

  <!--
    Left Container
  -->
	<div class="left-container">
    
    <!-- Details -->
    <div class="details round-border-shadow">

      <!-- Name & Address -->
      <div class="name">
  			<div class="picture">
  				<img src="{% static 'yplaces/images/default_place_picture.png' %}">
  			</div>
        <div class="address">
          <h1>{{ place.name }}</h1>
          <p>
            {{ place.address }}, {{ place.postal_code }} {{Â place.city }}
            <br>
            {{ place.country }}
          </p>
        </div>
        <div class="clear"></div>
      </div>

      <!-- Contacts -->
      <div class="contacts">
        <ul>
          <li>
            <i class="fa fa-arrows"></i>
            <a href="http://maps.google.com/?q={{ place.name|slugify }}@{{ place.latitude }},{{ place.longitude }}&z=17" target="_blank">Directions</a>
          </li>
          {% if place.phone_number %}
            <li>
              <i class="fa fa-phone"></i>
              <span class="value">{{ place.phone_number }}</span>
            </li>
          {% endif %}
          {% if place.email %}
            <li>
              <i class="fa fa-envelope"></i>
              <span class="value"><a href="mailto:{{ place.email }}" target="_blank">{{ place.email }}</a></span>
            </li>
          {% endif %}
          {% if place.website %}
            <li>
              <i class="fa fa-link"></i>
              <span class="value"><a href="{{ place.website }}" target="_blank">Website</a></span>
            </li>
          {% endif %}
        </ul>
      </div>

      <!-- Average Rating -->
      <div class="rating">
        <div class="star-rating" style="margin: auto;"><div style="width:{{ rating.get_average_percentage }}%"></div></div>
      </div>
		</div>

    <!-- Photos -->
    <div class="photos">
      <div>
        <img src="{% static 'yplaces/images/francesinha.jpg' %}" class="img-thumbnail">
      </div>
      <div>
        <img src="{% static 'yplaces/images/francesinha2.jpg' %}" class="img-thumbnail">
      </div>
      <div>
        <img src="{% static 'yplaces/images/francesinha3.jpg' %}" class="img-thumbnail">
      </div>
      <div>
        <i class="fa fa-picture-o fa-5x"></i>
        <p><strong>View All</strong></p>
      </div>
    </div>

    <!-- Reviews -->
    <div class="reviews round-border-shadow">
      <div class="actions">
        <button class="btn btn-primary btn-sm">
          <i class="fa fa-star"></i>
          <strong>Write a Review</strong>
        </button>
        <button class="btn btn-sm">
          <i class="fa fa-camera"></i>
          Add Photo
        </button>
      </div>
      {% if place.review_set.all %}
      <ul>
        {% for review in place.review_set.all %}
        <li>
          <div class="avatar">
            <img src="{{ review.user.get_photo_url }}" class="img-rounded">
          </div>
          <div class="comment">
            <div class="star-rating-sm"><div style="width:{{ review.get_rating_percentage }}%"></div></div>
            <div class="message">
              {{ review.comment }}
              <br>
              <span>{{ review.user.name }} // {{ review.date }}</span>
            </div>
          </div>
          <div class="clear"></div>
        </li>
        {% endfor %}
      </ul>
      {% endif %}
    </div>

	</div>
	
  <!--
    Right Container
  -->
  <div class="right-container">
		
    <!-- Map -->
    <div id="map" class="round-border-shadow">
    </div>
	</div>
</div>

{% endblock %}

{% block javascript %}
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script type="application/javascript">
     /*
      * Google Maps
      */
      function initialize(){
      
        // Load the map with the restaurant's coordinates
        var latlng = new google.maps.LatLng({{ place.latitude }}, {{ place.longitude }});
        var myOptions = {
          zoom: 15,
          center: latlng,
          //disableDefaultUI: true,
          navigationControl: true,
          scrollwheel: false,
          mapTypeId: google.maps.MapTypeId.ROADMAP,
        };
        var map = new google.maps.Map(document.getElementById('map'), myOptions);
      
        // Place a marker
        var marker = new google.maps.Marker({
          position: latlng,
          map: map,
          title: '{{ place.name }}'
        });
      }
      window.onload = initialize;
  </script>
{% endblock %}